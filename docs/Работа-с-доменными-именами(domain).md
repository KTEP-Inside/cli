## Содержание

1. [Основная информация](#основная-информация)
2. [Глобальные флаги](#глобальные-флаги)
3. [Список команд](#список-команд)
   1. [create](#create)
   2. [remove](#remove)
   3. [ls](#ls)
   4. [activate](#activate)
   5. [deactivate](#deactivate)
   6. [generate-cert](#generate-cert)
   7. [regenerate](#regenerate)

## Основная информация

Модуль отвечающий за работу с доменами и поддоменами, SSL сертификатами и глобальными конфигурациям nginx.

```bash
kinsidectl domain subcommand [..args] [...flags]
```

## Глобальные флаги

1. -h/--help - выводит подсказку со списком команд и объяснениями их работы.

## Список команд

1. [create](#create)
2. [remove](#remove)
3. [ls](#ls)
4. [activate](#activate)
5. [deactivate](#deactivate)
6. [generate-cert](#generate-cert)
7. [regenerate](#regenerate)

### Create

Создает конфигурации для глобального nginx'а, генерирует SSL сертификаты, которые подключаются в конфигурацию nginx'а и создает директорию для логов.

По удачному завершению выводит полный адрес домена, пути до файлов/директорий и текущее состояние(активный или нет).

По умолчанию берет родительский домен из [базовой конфигурации](./Глобальное-состояние-и-файлы-конфигурации.md#базовая-конфигурация) и создает на ее основе домен.

#### Обязательные флаги

1. --project - название проекта, к которому будет привязан домен

Пример использования:

```bash
kinsidectl domain create --project project-name
```

Будет созданы файлы и тд для домена ktep-inside.local или другого, который указан в базовой конфигурации.

> **Внимание!!! Создавать доменное имя нужно после того, как под проект были [выделены порты](<./Работа-с-портами(ports).md#create>). В ином случае будет выдаваться ошибка.**

#### Флаги:

1. --subdomain - указывает поддомен главного домена. Поддерживает только поддомены первого уровня
   Пример использования:

```bash
kinsidectl domain create --subdomain main --project project-name
```

Будет созданы файлы и тд для домена main.ktep-inside.local или другого, который указан в базовой конфигурации. 2. --domain - указывает родительский домен
Пример использования:

```bash
kinsidectl domain create --domain kinside.local --project project-name
```

Будет созданы файлы и тд для домена kinside.local или другого, который
указан в базовой конфигурации. 3. --ports-type - тип выделяемого порта(web, back, db и тд). По умолчанию имеет значение web. 4. --ports-index - индекс порта из массива выделенных по данному направлению. По умолчанию 0. 5. --activate - Активирует конфигурацию доменного имени, после создания. По умолчанию он не активирован.

### Remove

Удаляет доменное имя и все связанные с ним файлы. А также отвязывает его от проекта.

Пример использования:

```bash
kinsidectl domain remove main.ktep-inside.local
```

### Ls

Выводит список доменных имен на сервере.

Пример использования:

```bash
kinsidectl domain ls
```

Формат вывода:
| N | subdomain | domain | project | status | createdAt |
|---|-----------|--------|--------| ----- |-----------|
| 0 | test | ktep-inside.local | testing |activated |2023-03-15 |

#### Флаги

1. --activated - Выводит список активных доменных имен
2. --deactivated - Выводит список неактивных доменных имен

### Activate

Активирует доменное имя. Если оно активировано, то ничего не делает

Пример использования:

```bash
kinsidectl domain activate main.ktep-inside.local
```

### Deactivate

Деактивирует доменное имя. Если оно активировано, то ничего не делает

Пример использования:

```bash
kinsidectl domain activate main.ktep-inside.local
```

### Generate-cert

Заново генерирует сертификаты для доменного имени.

Пример использования:

```bash
kinsidectl domain generate-cert main.ktep-inside.local
```

### Regenerate

Заново генерирует все сертификаты, конфигурации и директории для доменного имени.

Пример использования:

```bash
kinsidectl domain regenerate main.ktep-inside.local
```
